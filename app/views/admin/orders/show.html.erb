<h2>注文履歴詳細</h2>
<div class="container">
 <div class="row">
  <div class="col">

   <table>
     <tr>
      <td>購入者</td>
      <td><%= @order.customer.last_name+@order.customer.first_name %></td>
     </tr>

     <tr>
      <td>注文日</td>
      <td><%= @order.created_at.strftime('%Y/%m/%d')%></td>
     </tr>


     <tr>
      <td>配送先</td>
      <td><p>〒<%= @order.delivery_target_postal_code%><%= @order.delivery_address%></p>
      <p><%= @order.delivery_target_full_name%></p></td>
     </tr>

     <tr>
      <td>支払方法</td>
      <td><%= @order.payment_method_i18n%></td>
     </tr>

     <tr>
         <%= form_with model: @order, url: admin_order_path, method: :patch do |f| %>
      <td>注文ステータス</td>
      <td><%#= f.select :status, [['入金待ち',0],['入金確認',1],['製作中',2],['発送準備中',3],['発送済み',4]] %></td>
      <td><%= f.select :status,Order.statuses.keys.map{|k| [I18n.t("enums.order.status.#{k}"), k]} %></td>


      <td><%= f.submit '更新',class:'btn btn-success' %></td>
     </tr>


     <%end%>
   </table>
   <div class="col">
    <table>
     <tr>
      <td>商品名</td>
      <td>単価（税込）</td>
      <td>数量</td>
      <td>小計</td>
      <td>制作ステータス</td>

      <tr>
      <% @order.order_details.each do |order_detail| %>

      <td><%=order_detail.item.name%></td>
      <td><%=order_detail.item.with_tax_price%></td>
      <td><%=order_detail.amount%></td>
      <td><%=order_detail.item.with_tax_price*order_detail.amount %></td>

      <%= form_with model: order_detail, url: admin_order_detail_path(order_detail.id), method: :patch do |f| %>
      <td><%#= f.select :making_status, [['制作不可',0],['制作待ち',1],['製作中',2],['制作完了',3]], { include_blank: true, selected: 0 } %></td>
        <td><%= f.select :making_status,OrderDetail.making_statuses.keys.map{|k| [I18n.t("enums.order_detail.making_status.#{k}"), k]} %></td>
        <td><%=f.submit"更新",class:'btn btn-success'%></td>
      <%end%>
      <td></td>

     </tr>
    <%end%>
    </table>
  </div>
 </div>
</div>